2018-08-25 03:56:32
Model(s): ['linear']
Sim Start Day: 156
Training feature minutes: [1, 5, 10, 20, 30, 40, 50, 60, 120, 240, 480, 960]
Training Min(s): ['none']
Test Min(s): [1440]
Poly(s): [3]
Coin feature configuration: {'target': 'btcusdt', 'alt': 'ethusdt', 'through': 'trxeth', 'excharb_btc': 'btcusdt', 'excharb_eth': 'ethusdt'}
Query execution failed: {'QueryExecution': {'QueryExecutionId': '10e07f8c-5476-414c-a833-0a4f842e2dde', 'Query': "WITH target_btcusdt AS (\n                                    SELECT coin_partition AS btcusdt_coin_partition\n                                        , from_unixtime(cast(open_timestamp AS BIGINT) / 1000) AS btcusdt_trade_datetime\n                                        , DATE(from_unixtime(cast(open_timestamp AS BIGINT) / 1000)) AS btcusdt_trade_date\n                                        , (CAST(open_timestamp AS BIGINT) / 1000 / 60) AS btcusdt_trade_minute\n                                        , CAST(open AS DOUBLE) AS btcusdt_open\n                                        , CAST(high AS DOUBLE) AS btcusdt_high\n                                        , CAST(low AS DOUBLE) AS btcusdt_low\n                                        , CAST(close AS DOUBLE) AS btcusdt_close\n                                        , CAST(volume AS DOUBLE) AS btcusdt_volume\n                                    FROM cobinhood.historic_candlesticks \n                                    WHERE coin_partition = 'btcusdt'\n                                    ),alt_ethusdt AS (\n                                    SELECT coin_partition AS ethusdt_coin_partition\n                                        , from_unixtime(cast(open_timestamp AS BIGINT) / 1000) AS ethusdt_trade_datetime\n                                        , DATE(from_unixtime(cast(open_timestamp AS BIGINT) / 1000)) AS ethusdt_trade_date\n                                        , (CAST(open_timestamp AS BIGINT) / 1000 / 60) AS ethusdt_trade_minute\n                                        , CAST(open AS DOUBLE) AS ethusdt_open\n                                        , CAST(high AS DOUBLE) AS ethusdt_high\n                                        , CAST(low AS DOUBLE) AS ethusdt_low\n                                        , CAST(close AS DOUBLE) AS ethusdt_close\n                                        , CAST(volume AS DOUBLE) AS ethusdt_volume\n                                    FROM cobinhood.historic_candlesticks \n                                    WHERE coin_partition = 'ethusdt'\n                                    ),through_trxeth AS (\n                                    SELECT coin_partition AS trxeth_coin_partition\n                                        , from_unixtime(cast(open_timestamp AS BIGINT) / 1000) AS trxeth_trade_datetime\n                                        , DATE(from_unixtime(cast(open_timestamp AS BIGINT) / 1000)) AS trxeth_trade_date\n                                        , (CAST(open_timestamp AS BIGINT) / 1000 / 60) AS trxeth_trade_minute\n                                        , CAST(open AS DOUBLE) AS trxeth_open\n                                        , CAST(high AS DOUBLE) AS trxeth_high\n                                        , CAST(low AS DOUBLE) AS trxeth_low\n                                        , CAST(close AS DOUBLE) AS trxeth_close\n                                        , CAST(volume AS DOUBLE) AS trxeth_volume\n                                    FROM cobinhood.historic_candlesticks \n                                    WHERE coin_partition = 'trxeth'\n                                    ),excharb_btc_btcusdt AS (\n                                    SELECT coin_partition AS btcusdt_coin_partition\n                                        , from_unixtime(cast(open_timestamp AS BIGINT) / 1000) AS btcusdt_trade_datetime\n                                        , DATE(from_unixtime(cast(open_timestamp AS BIGINT) / 1000)) AS btcusdt_trade_date\n                                        , (CAST(open_timestamp AS BIGINT) / 1000 / 60) AS btcusdt_trade_minute\n                                        , CAST(open AS DOUBLE) AS btcusdt_open\n                                        , CAST(high AS DOUBLE) AS btcusdt_high\n                                        , CAST(low AS DOUBLE) AS btcusdt_low\n                                        , CAST(close AS DOUBLE) AS btcusdt_close\n                                        , CAST(volume AS DOUBLE) AS btcusdt_volume\n                                    FROM cobinhood.historic_candlesticks \n                                    WHERE coin_partition = 'btcusdt'\n                                    ),excharb_eth_ethusdt AS (\n                                    SELECT coin_partition AS ethusdt_coin_partition\n                                        , from_unixtime(cast(open_timestamp AS BIGINT) / 1000) AS ethusdt_trade_datetime\n                                        , DATE(from_unixtime(cast(open_timestamp AS BIGINT) / 1000)) AS ethusdt_trade_date\n                                        , (CAST(open_timestamp AS BIGINT) / 1000 / 60) AS ethusdt_trade_minute\n                                        , CAST(open AS DOUBLE) AS ethusdt_open\n                                        , CAST(high AS DOUBLE) AS ethusdt_high\n                                        , CAST(low AS DOUBLE) AS ethusdt_low\n                                        , CAST(close AS DOUBLE) AS ethusdt_close\n                                        , CAST(volume AS DOUBLE) AS ethusdt_volume\n                                    FROM cobinhood.historic_candlesticks \n                                    WHERE coin_partition = 'ethusdt'\n                                    )\n                            SELECT btcusdt_trade_datetime, btcusdt_trade_date, btcusdt_trade_minute\n                                        , CAST(day_of_week(btcusdt_trade_datetime) AS SMALLINT) as trade_day_of_week\n                                        , CAST(hour(btcusdt_trade_datetime) AS SMALLINT) as trade_hour,btcusdt_open, btcusdt_high, btcusdt_low, btcusdt_close, btcusdt_volume,ethusdt_open, ethusdt_high, ethusdt_low, ethusdt_close, ethusdt_volume,trxeth_open, trxeth_high, trxeth_low, trxeth_close, trxeth_volume\n                                ,AVG((btcusdt_close-ethusdt_close)/btcusdt_close) OVER (PARTITION BY btcusdt_coin_partition ORDER BY btcusdt_trade_minute ASC ROWS 5 PRECEDING) \n                                                    - ((btcusdt_close-ethusdt_close)/btcusdt_close) AS avg_5_ethusdt_close_interaction,AVG((btcusdt_close-ethusdt_close)/btcusdt_close) OVER (PARTITION BY btcusdt_coin_partition ORDER BY btcusdt_trade_minute ASC ROWS 10 PRECEDING) \n                                                    - ((btcusdt_close-ethusdt_close)/btcusdt_close) AS avg_10_ethusdt_close_interaction,AVG((btcusdt_close-ethusdt_close)/btcusdt_close) OVER (PARTITION BY btcusdt_coin_partition ORDER BY btcusdt_trade_minute ASC ROWS 20 PRECEDING) \n                                                    - ((btcusdt_close-ethusdt_close)/btcusdt_close) AS avg_20_ethusdt_close_interaction\n                                ,AVG((btcusdt_close-btcusdt_excharb_close)/btcusdt_close) OVER (PARTITION BY btcusdt_coin_partition ORDER BY btcusdt_trade_minute ASC ROWS 1 PRECEDING) \n                                                    - ((btcusdt_close-btcusdt_excharb_close)/btcusdt_close) AS avg_1_btcusdt_excharb_close_interaction,AVG((btcusdt_close-btcusdt_excharb_close)/btcusdt_close) OVER (PARTITION BY btcusdt_coin_partition ORDER BY btcusdt_trade_minute ASC ROWS 2 PRECEDING) \n                                                    - ((btcusdt_close-btcusdt_excharb_close)/btcusdt_close) AS avg_2_btcusdt_excharb_close_interaction,AVG((btcusdt_close-btcusdt_excharb_close)/btcusdt_close) OVER (PARTITION BY btcusdt_coin_partition ORDER BY btcusdt_trade_minute ASC ROWS 3 PRECEDING) \n                                                    - ((btcusdt_close-btcusdt_excharb_close)/btcusdt_close) AS avg_3_btcusdt_excharb_close_interaction,AVG((btcusdt_close-ethusdt_excharb_close)/btcusdt_close) OVER (PARTITION BY btcusdt_coin_partition ORDER BY btcusdt_trade_minute ASC ROWS 1 PRECEDING) \n                                                    - ((btcusdt_close-ethusdt_excharb_close)/btcusdt_close) AS avg_1_ethusdt_excharb_close_interaction,AVG((btcusdt_close-ethusdt_excharb_close)/btcusdt_close) OVER (PARTITION BY btcusdt_coin_partition ORDER BY btcusdt_trade_minute ASC ROWS 2 PRECEDING) \n                                                    - ((btcusdt_close-ethusdt_excharb_close)/btcusdt_close) AS avg_2_ethusdt_excharb_close_interaction,AVG((btcusdt_close-ethusdt_excharb_close)/btcusdt_close) OVER (PARTITION BY btcusdt_coin_partition ORDER BY btcusdt_trade_minute ASC ROWS 3 PRECEDING) \n                                                    - ((btcusdt_close-ethusdt_excharb_close)/btcusdt_close) AS avg_3_ethusdt_excharb_close_interaction\n                                ,((LAG(btcusdt_close, 3) OVER (ORDER BY btcusdt_trade_minute DESC) - btcusdt_close) / btcusdt_close) * 100 AS futr_3_close_perc_chg,((LAG(btcusdt_close, 4) OVER (ORDER BY btcusdt_trade_minute DESC) - btcusdt_close) / btcusdt_close) * 100 AS futr_4_close_perc_chg,((LAG(btcusdt_close, 5) OVER (ORDER BY btcusdt_trade_minute DESC) - btcusdt_close) / btcusdt_close) * 100 AS futr_5_close_perc_chg,((LAG(btcusdt_close, 6) OVER (ORDER BY btcusdt_trade_minute DESC) - btcusdt_close) / btcusdt_close) * 100 AS futr_6_close_perc_chg,((LAG(btcusdt_close, 7) OVER (ORDER BY btcusdt_trade_minute DESC) - btcusdt_close) / btcusdt_close) * 100 AS futr_7_close_perc_chg\n                                ,((btcusdt_close - LEAD(btcusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_1_btcusdt_close_perc_chg\n                                            ,(((btcusdt_close - LEAD(btcusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))\n                                            - ((btcusdt_close - LEAD(btcusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))) * 100 AS prev_1_btcusdt_close_rate_chg\n                                            ,((btcusdt_high - LEAD(btcusdt_high, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_high, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_1_btcusdt_high_perc_chg\n                                            ,((btcusdt_low - LEAD(btcusdt_low, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_low, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_1_btcusdt_low_perc_chg\n                                            ,COALESCE(TRY(((btcusdt_volume - LEAD(btcusdt_volume, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_volume, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100),0) AS prev_1_btcusdt_volume_perc_chg\n                                            ,((btcusdt_close - LEAD(btcusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 * btcusdt_volume AS prev_1_btcusdt_volume_direction,((btcusdt_close - LEAD(btcusdt_close, 5) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 5) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_5_btcusdt_close_perc_chg\n                                            ,(((btcusdt_close - LEAD(btcusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))\n                                            - ((btcusdt_close - LEAD(btcusdt_close, 5) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 5) OVER (ORDER BY btcusdt_trade_minute DESC))) * 100 AS prev_5_btcusdt_close_rate_chg\n                                            ,((btcusdt_high - LEAD(btcusdt_high, 5) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_high, 5) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_5_btcusdt_high_perc_chg\n                                            ,((btcusdt_low - LEAD(btcusdt_low, 5) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_low, 5) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_5_btcusdt_low_perc_chg\n                                            ,COALESCE(TRY(((btcusdt_volume - LEAD(btcusdt_volume, 5) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_volume, 5) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100),0) AS prev_5_btcusdt_volume_perc_chg\n                                            ,((btcusdt_close - LEAD(btcusdt_close, 5) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 5) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 * btcusdt_volume AS prev_5_btcusdt_volume_direction,((btcusdt_close - LEAD(btcusdt_close, 10) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 10) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_10_btcusdt_close_perc_chg\n                                            ,(((btcusdt_close - LEAD(btcusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))\n                                            - ((btcusdt_close - LEAD(btcusdt_close, 10) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 10) OVER (ORDER BY btcusdt_trade_minute DESC))) * 100 AS prev_10_btcusdt_close_rate_chg\n                                            ,((btcusdt_high - LEAD(btcusdt_high, 10) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_high, 10) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_10_btcusdt_high_perc_chg\n                                            ,((btcusdt_low - LEAD(btcusdt_low, 10) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_low, 10) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_10_btcusdt_low_perc_chg\n                                            ,COALESCE(TRY(((btcusdt_volume - LEAD(btcusdt_volume, 10) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_volume, 10) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100),0) AS prev_10_btcusdt_volume_perc_chg\n                                            ,((btcusdt_close - LEAD(btcusdt_close, 10) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 10) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 * btcusdt_volume AS prev_10_btcusdt_volume_direction,((btcusdt_close - LEAD(btcusdt_close, 20) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 20) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_20_btcusdt_close_perc_chg\n                                            ,(((btcusdt_close - LEAD(btcusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))\n                                            - ((btcusdt_close - LEAD(btcusdt_close, 20) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 20) OVER (ORDER BY btcusdt_trade_minute DESC))) * 100 AS prev_20_btcusdt_close_rate_chg\n                                            ,((btcusdt_high - LEAD(btcusdt_high, 20) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_high, 20) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_20_btcusdt_high_perc_chg\n                                            ,((btcusdt_low - LEAD(btcusdt_low, 20) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_low, 20) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_20_btcusdt_low_perc_chg\n                                            ,COALESCE(TRY(((btcusdt_volume - LEAD(btcusdt_volume, 20) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_volume, 20) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100),0) AS prev_20_btcusdt_volume_perc_chg\n                                            ,((btcusdt_close - LEAD(btcusdt_close, 20) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 20) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 * btcusdt_volume AS prev_20_btcusdt_volume_direction,((btcusdt_close - LEAD(btcusdt_close, 30) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 30) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_30_btcusdt_close_perc_chg\n                                            ,(((btcusdt_close - LEAD(btcusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))\n                                            - ((btcusdt_close - LEAD(btcusdt_close, 30) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 30) OVER (ORDER BY btcusdt_trade_minute DESC))) * 100 AS prev_30_btcusdt_close_rate_chg\n                                            ,((btcusdt_high - LEAD(btcusdt_high, 30) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_high, 30) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_30_btcusdt_high_perc_chg\n                                            ,((btcusdt_low - LEAD(btcusdt_low, 30) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_low, 30) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_30_btcusdt_low_perc_chg\n                                            ,COALESCE(TRY(((btcusdt_volume - LEAD(btcusdt_volume, 30) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_volume, 30) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100),0) AS prev_30_btcusdt_volume_perc_chg\n                                            ,((btcusdt_close - LEAD(btcusdt_close, 30) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 30) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 * btcusdt_volume AS prev_30_btcusdt_volume_direction,((btcusdt_close - LEAD(btcusdt_close, 40) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 40) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_40_btcusdt_close_perc_chg\n                                            ,(((btcusdt_close - LEAD(btcusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))\n                                            - ((btcusdt_close - LEAD(btcusdt_close, 40) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 40) OVER (ORDER BY btcusdt_trade_minute DESC))) * 100 AS prev_40_btcusdt_close_rate_chg\n                                            ,((btcusdt_high - LEAD(btcusdt_high, 40) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_high, 40) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_40_btcusdt_high_perc_chg\n                                            ,((btcusdt_low - LEAD(btcusdt_low, 40) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_low, 40) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_40_btcusdt_low_perc_chg\n                                            ,COALESCE(TRY(((btcusdt_volume - LEAD(btcusdt_volume, 40) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_volume, 40) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100),0) AS prev_40_btcusdt_volume_perc_chg\n                                            ,((btcusdt_close - LEAD(btcusdt_close, 40) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 40) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 * btcusdt_volume AS prev_40_btcusdt_volume_direction,((btcusdt_close - LEAD(btcusdt_close, 50) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 50) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_50_btcusdt_close_perc_chg\n                                            ,(((btcusdt_close - LEAD(btcusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))\n                                            - ((btcusdt_close - LEAD(btcusdt_close, 50) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 50) OVER (ORDER BY btcusdt_trade_minute DESC))) * 100 AS prev_50_btcusdt_close_rate_chg\n                                            ,((btcusdt_high - LEAD(btcusdt_high, 50) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_high, 50) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_50_btcusdt_high_perc_chg\n                                            ,((btcusdt_low - LEAD(btcusdt_low, 50) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_low, 50) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_50_btcusdt_low_perc_chg\n                                            ,COALESCE(TRY(((btcusdt_volume - LEAD(btcusdt_volume, 50) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_volume, 50) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100),0) AS prev_50_btcusdt_volume_perc_chg\n                                            ,((btcusdt_close - LEAD(btcusdt_close, 50) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 50) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 * btcusdt_volume AS prev_50_btcusdt_volume_direction,((btcusdt_close - LEAD(btcusdt_close, 60) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 60) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_60_btcusdt_close_perc_chg\n                                            ,(((btcusdt_close - LEAD(btcusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))\n                                            - ((btcusdt_close - LEAD(btcusdt_close, 60) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 60) OVER (ORDER BY btcusdt_trade_minute DESC))) * 100 AS prev_60_btcusdt_close_rate_chg\n                                            ,((btcusdt_high - LEAD(btcusdt_high, 60) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_high, 60) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_60_btcusdt_high_perc_chg\n                                            ,((btcusdt_low - LEAD(btcusdt_low, 60) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_low, 60) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_60_btcusdt_low_perc_chg\n                                            ,COALESCE(TRY(((btcusdt_volume - LEAD(btcusdt_volume, 60) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_volume, 60) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100),0) AS prev_60_btcusdt_volume_perc_chg\n                                            ,((btcusdt_close - LEAD(btcusdt_close, 60) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 60) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 * btcusdt_volume AS prev_60_btcusdt_volume_direction,((btcusdt_close - LEAD(btcusdt_close, 120) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 120) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_120_btcusdt_close_perc_chg\n                                            ,(((btcusdt_close - LEAD(btcusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))\n                                            - ((btcusdt_close - LEAD(btcusdt_close, 120) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 120) OVER (ORDER BY btcusdt_trade_minute DESC))) * 100 AS prev_120_btcusdt_close_rate_chg\n                                            ,((btcusdt_high - LEAD(btcusdt_high, 120) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_high, 120) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_120_btcusdt_high_perc_chg\n                                            ,((btcusdt_low - LEAD(btcusdt_low, 120) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_low, 120) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_120_btcusdt_low_perc_chg\n                                            ,COALESCE(TRY(((btcusdt_volume - LEAD(btcusdt_volume, 120) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_volume, 120) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100),0) AS prev_120_btcusdt_volume_perc_chg\n                                            ,((btcusdt_close - LEAD(btcusdt_close, 120) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 120) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 * btcusdt_volume AS prev_120_btcusdt_volume_direction,((btcusdt_close - LEAD(btcusdt_close, 240) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 240) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_240_btcusdt_close_perc_chg\n                                            ,(((btcusdt_close - LEAD(btcusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))\n                                            - ((btcusdt_close - LEAD(btcusdt_close, 240) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 240) OVER (ORDER BY btcusdt_trade_minute DESC))) * 100 AS prev_240_btcusdt_close_rate_chg\n                                            ,((btcusdt_high - LEAD(btcusdt_high, 240) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_high, 240) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_240_btcusdt_high_perc_chg\n                                            ,((btcusdt_low - LEAD(btcusdt_low, 240) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_low, 240) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_240_btcusdt_low_perc_chg\n                                            ,COALESCE(TRY(((btcusdt_volume - LEAD(btcusdt_volume, 240) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_volume, 240) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100),0) AS prev_240_btcusdt_volume_perc_chg\n                                            ,((btcusdt_close - LEAD(btcusdt_close, 240) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 240) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 * btcusdt_volume AS prev_240_btcusdt_volume_direction,((btcusdt_close - LEAD(btcusdt_close, 480) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 480) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_480_btcusdt_close_perc_chg\n                                            ,(((btcusdt_close - LEAD(btcusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))\n                                            - ((btcusdt_close - LEAD(btcusdt_close, 480) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 480) OVER (ORDER BY btcusdt_trade_minute DESC))) * 100 AS prev_480_btcusdt_close_rate_chg\n                                            ,((btcusdt_high - LEAD(btcusdt_high, 480) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_high, 480) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_480_btcusdt_high_perc_chg\n                                            ,((btcusdt_low - LEAD(btcusdt_low, 480) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_low, 480) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_480_btcusdt_low_perc_chg\n                                            ,COALESCE(TRY(((btcusdt_volume - LEAD(btcusdt_volume, 480) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_volume, 480) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100),0) AS prev_480_btcusdt_volume_perc_chg\n                                            ,((btcusdt_close - LEAD(btcusdt_close, 480) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 480) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 * btcusdt_volume AS prev_480_btcusdt_volume_direction,((btcusdt_close - LEAD(btcusdt_close, 960) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 960) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_960_btcusdt_close_perc_chg\n                                            ,(((btcusdt_close - LEAD(btcusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))\n                                            - ((btcusdt_close - LEAD(btcusdt_close, 960) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 960) OVER (ORDER BY btcusdt_trade_minute DESC))) * 100 AS prev_960_btcusdt_close_rate_chg\n                                            ,((btcusdt_high - LEAD(btcusdt_high, 960) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_high, 960) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_960_btcusdt_high_perc_chg\n                                            ,((btcusdt_low - LEAD(btcusdt_low, 960) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_low, 960) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_960_btcusdt_low_perc_chg\n                                            ,COALESCE(TRY(((btcusdt_volume - LEAD(btcusdt_volume, 960) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_volume, 960) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100),0) AS prev_960_btcusdt_volume_perc_chg\n                                            ,((btcusdt_close - LEAD(btcusdt_close, 960) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(btcusdt_close, 960) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 * btcusdt_volume AS prev_960_btcusdt_volume_direction,((ethusdt_close - LEAD(ethusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_1_ethusdt_close_perc_chg\n                                            ,(((ethusdt_close - LEAD(ethusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))\n                                            - ((ethusdt_close - LEAD(ethusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))) * 100 AS prev_1_ethusdt_close_rate_chg\n                                            ,((ethusdt_high - LEAD(ethusdt_high, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_high, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_1_ethusdt_high_perc_chg\n                                            ,((ethusdt_low - LEAD(ethusdt_low, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_low, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_1_ethusdt_low_perc_chg\n                                            ,COALESCE(TRY(((ethusdt_volume - LEAD(ethusdt_volume, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_volume, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100),0) AS prev_1_ethusdt_volume_perc_chg\n                                            ,((ethusdt_close - LEAD(ethusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 * ethusdt_volume AS prev_1_ethusdt_volume_direction,((ethusdt_close - LEAD(ethusdt_close, 5) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 5) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_5_ethusdt_close_perc_chg\n                                            ,(((ethusdt_close - LEAD(ethusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))\n                                            - ((ethusdt_close - LEAD(ethusdt_close, 5) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 5) OVER (ORDER BY btcusdt_trade_minute DESC))) * 100 AS prev_5_ethusdt_close_rate_chg\n                                            ,((ethusdt_high - LEAD(ethusdt_high, 5) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_high, 5) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_5_ethusdt_high_perc_chg\n                                            ,((ethusdt_low - LEAD(ethusdt_low, 5) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_low, 5) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_5_ethusdt_low_perc_chg\n                                            ,COALESCE(TRY(((ethusdt_volume - LEAD(ethusdt_volume, 5) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_volume, 5) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100),0) AS prev_5_ethusdt_volume_perc_chg\n                                            ,((ethusdt_close - LEAD(ethusdt_close, 5) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 5) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 * ethusdt_volume AS prev_5_ethusdt_volume_direction,((ethusdt_close - LEAD(ethusdt_close, 10) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 10) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_10_ethusdt_close_perc_chg\n                                            ,(((ethusdt_close - LEAD(ethusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))\n                                            - ((ethusdt_close - LEAD(ethusdt_close, 10) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 10) OVER (ORDER BY btcusdt_trade_minute DESC))) * 100 AS prev_10_ethusdt_close_rate_chg\n                                            ,((ethusdt_high - LEAD(ethusdt_high, 10) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_high, 10) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_10_ethusdt_high_perc_chg\n                                            ,((ethusdt_low - LEAD(ethusdt_low, 10) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_low, 10) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_10_ethusdt_low_perc_chg\n                                            ,COALESCE(TRY(((ethusdt_volume - LEAD(ethusdt_volume, 10) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_volume, 10) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100),0) AS prev_10_ethusdt_volume_perc_chg\n                                            ,((ethusdt_close - LEAD(ethusdt_close, 10) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 10) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 * ethusdt_volume AS prev_10_ethusdt_volume_direction,((ethusdt_close - LEAD(ethusdt_close, 20) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 20) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_20_ethusdt_close_perc_chg\n                                            ,(((ethusdt_close - LEAD(ethusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))\n                                            - ((ethusdt_close - LEAD(ethusdt_close, 20) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 20) OVER (ORDER BY btcusdt_trade_minute DESC))) * 100 AS prev_20_ethusdt_close_rate_chg\n                                            ,((ethusdt_high - LEAD(ethusdt_high, 20) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_high, 20) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_20_ethusdt_high_perc_chg\n                                            ,((ethusdt_low - LEAD(ethusdt_low, 20) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_low, 20) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_20_ethusdt_low_perc_chg\n                                            ,COALESCE(TRY(((ethusdt_volume - LEAD(ethusdt_volume, 20) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_volume, 20) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100),0) AS prev_20_ethusdt_volume_perc_chg\n                                            ,((ethusdt_close - LEAD(ethusdt_close, 20) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 20) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 * ethusdt_volume AS prev_20_ethusdt_volume_direction,((ethusdt_close - LEAD(ethusdt_close, 30) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 30) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_30_ethusdt_close_perc_chg\n                                            ,(((ethusdt_close - LEAD(ethusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))\n                                            - ((ethusdt_close - LEAD(ethusdt_close, 30) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 30) OVER (ORDER BY btcusdt_trade_minute DESC))) * 100 AS prev_30_ethusdt_close_rate_chg\n                                            ,((ethusdt_high - LEAD(ethusdt_high, 30) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_high, 30) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_30_ethusdt_high_perc_chg\n                                            ,((ethusdt_low - LEAD(ethusdt_low, 30) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_low, 30) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_30_ethusdt_low_perc_chg\n                                            ,COALESCE(TRY(((ethusdt_volume - LEAD(ethusdt_volume, 30) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_volume, 30) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100),0) AS prev_30_ethusdt_volume_perc_chg\n                                            ,((ethusdt_close - LEAD(ethusdt_close, 30) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 30) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 * ethusdt_volume AS prev_30_ethusdt_volume_direction,((ethusdt_close - LEAD(ethusdt_close, 40) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 40) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_40_ethusdt_close_perc_chg\n                                            ,(((ethusdt_close - LEAD(ethusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))\n                                            - ((ethusdt_close - LEAD(ethusdt_close, 40) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 40) OVER (ORDER BY btcusdt_trade_minute DESC))) * 100 AS prev_40_ethusdt_close_rate_chg\n                                            ,((ethusdt_high - LEAD(ethusdt_high, 40) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_high, 40) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_40_ethusdt_high_perc_chg\n                                            ,((ethusdt_low - LEAD(ethusdt_low, 40) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_low, 40) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_40_ethusdt_low_perc_chg\n                                            ,COALESCE(TRY(((ethusdt_volume - LEAD(ethusdt_volume, 40) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_volume, 40) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100),0) AS prev_40_ethusdt_volume_perc_chg\n                                            ,((ethusdt_close - LEAD(ethusdt_close, 40) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 40) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 * ethusdt_volume AS prev_40_ethusdt_volume_direction,((ethusdt_close - LEAD(ethusdt_close, 50) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 50) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_50_ethusdt_close_perc_chg\n                                            ,(((ethusdt_close - LEAD(ethusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))\n                                            - ((ethusdt_close - LEAD(ethusdt_close, 50) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 50) OVER (ORDER BY btcusdt_trade_minute DESC))) * 100 AS prev_50_ethusdt_close_rate_chg\n                                            ,((ethusdt_high - LEAD(ethusdt_high, 50) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_high, 50) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_50_ethusdt_high_perc_chg\n                                            ,((ethusdt_low - LEAD(ethusdt_low, 50) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_low, 50) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_50_ethusdt_low_perc_chg\n                                            ,COALESCE(TRY(((ethusdt_volume - LEAD(ethusdt_volume, 50) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_volume, 50) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100),0) AS prev_50_ethusdt_volume_perc_chg\n                                            ,((ethusdt_close - LEAD(ethusdt_close, 50) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 50) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 * ethusdt_volume AS prev_50_ethusdt_volume_direction,((ethusdt_close - LEAD(ethusdt_close, 60) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 60) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_60_ethusdt_close_perc_chg\n                                            ,(((ethusdt_close - LEAD(ethusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))\n                                            - ((ethusdt_close - LEAD(ethusdt_close, 60) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 60) OVER (ORDER BY btcusdt_trade_minute DESC))) * 100 AS prev_60_ethusdt_close_rate_chg\n                                            ,((ethusdt_high - LEAD(ethusdt_high, 60) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_high, 60) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_60_ethusdt_high_perc_chg\n                                            ,((ethusdt_low - LEAD(ethusdt_low, 60) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_low, 60) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_60_ethusdt_low_perc_chg\n                                            ,COALESCE(TRY(((ethusdt_volume - LEAD(ethusdt_volume, 60) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_volume, 60) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100),0) AS prev_60_ethusdt_volume_perc_chg\n                                            ,((ethusdt_close - LEAD(ethusdt_close, 60) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 60) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 * ethusdt_volume AS prev_60_ethusdt_volume_direction,((ethusdt_close - LEAD(ethusdt_close, 120) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 120) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_120_ethusdt_close_perc_chg\n                                            ,(((ethusdt_close - LEAD(ethusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))\n                                            - ((ethusdt_close - LEAD(ethusdt_close, 120) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 120) OVER (ORDER BY btcusdt_trade_minute DESC))) * 100 AS prev_120_ethusdt_close_rate_chg\n                                            ,((ethusdt_high - LEAD(ethusdt_high, 120) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_high, 120) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_120_ethusdt_high_perc_chg\n                                            ,((ethusdt_low - LEAD(ethusdt_low, 120) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_low, 120) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_120_ethusdt_low_perc_chg\n                                            ,COALESCE(TRY(((ethusdt_volume - LEAD(ethusdt_volume, 120) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_volume, 120) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100),0) AS prev_120_ethusdt_volume_perc_chg\n                                            ,((ethusdt_close - LEAD(ethusdt_close, 120) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 120) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 * ethusdt_volume AS prev_120_ethusdt_volume_direction,((ethusdt_close - LEAD(ethusdt_close, 240) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 240) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_240_ethusdt_close_perc_chg\n                                            ,(((ethusdt_close - LEAD(ethusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))\n                                            - ((ethusdt_close - LEAD(ethusdt_close, 240) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 240) OVER (ORDER BY btcusdt_trade_minute DESC))) * 100 AS prev_240_ethusdt_close_rate_chg\n                                            ,((ethusdt_high - LEAD(ethusdt_high, 240) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_high, 240) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_240_ethusdt_high_perc_chg\n                                            ,((ethusdt_low - LEAD(ethusdt_low, 240) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_low, 240) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_240_ethusdt_low_perc_chg\n                                            ,COALESCE(TRY(((ethusdt_volume - LEAD(ethusdt_volume, 240) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_volume, 240) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100),0) AS prev_240_ethusdt_volume_perc_chg\n                                            ,((ethusdt_close - LEAD(ethusdt_close, 240) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 240) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 * ethusdt_volume AS prev_240_ethusdt_volume_direction,((ethusdt_close - LEAD(ethusdt_close, 480) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 480) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_480_ethusdt_close_perc_chg\n                                            ,(((ethusdt_close - LEAD(ethusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))\n                                            - ((ethusdt_close - LEAD(ethusdt_close, 480) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 480) OVER (ORDER BY btcusdt_trade_minute DESC))) * 100 AS prev_480_ethusdt_close_rate_chg\n                                            ,((ethusdt_high - LEAD(ethusdt_high, 480) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_high, 480) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_480_ethusdt_high_perc_chg\n                                            ,((ethusdt_low - LEAD(ethusdt_low, 480) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_low, 480) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_480_ethusdt_low_perc_chg\n                                            ,COALESCE(TRY(((ethusdt_volume - LEAD(ethusdt_volume, 480) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_volume, 480) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100),0) AS prev_480_ethusdt_volume_perc_chg\n                                            ,((ethusdt_close - LEAD(ethusdt_close, 480) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 480) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 * ethusdt_volume AS prev_480_ethusdt_volume_direction,((ethusdt_close - LEAD(ethusdt_close, 960) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 960) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_960_ethusdt_close_perc_chg\n                                            ,(((ethusdt_close - LEAD(ethusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))\n                                            - ((ethusdt_close - LEAD(ethusdt_close, 960) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 960) OVER (ORDER BY btcusdt_trade_minute DESC))) * 100 AS prev_960_ethusdt_close_rate_chg\n                                            ,((ethusdt_high - LEAD(ethusdt_high, 960) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_high, 960) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_960_ethusdt_high_perc_chg\n                                            ,((ethusdt_low - LEAD(ethusdt_low, 960) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_low, 960) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_960_ethusdt_low_perc_chg\n                                            ,COALESCE(TRY(((ethusdt_volume - LEAD(ethusdt_volume, 960) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_volume, 960) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100),0) AS prev_960_ethusdt_volume_perc_chg\n                                            ,((ethusdt_close - LEAD(ethusdt_close, 960) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(ethusdt_close, 960) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 * ethusdt_volume AS prev_960_ethusdt_volume_direction,((trxeth_close - LEAD(trxeth_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_1_trxeth_close_perc_chg\n                                            ,(((trxeth_close - LEAD(trxeth_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))\n                                            - ((trxeth_close - LEAD(trxeth_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))) * 100 AS prev_1_trxeth_close_rate_chg\n                                            ,((trxeth_high - LEAD(trxeth_high, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_high, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_1_trxeth_high_perc_chg\n                                            ,((trxeth_low - LEAD(trxeth_low, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_low, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_1_trxeth_low_perc_chg\n                                            ,COALESCE(TRY(((trxeth_volume - LEAD(trxeth_volume, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_volume, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100),0) AS prev_1_trxeth_volume_perc_chg\n                                            ,((trxeth_close - LEAD(trxeth_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 * trxeth_volume AS prev_1_trxeth_volume_direction,((trxeth_close - LEAD(trxeth_close, 5) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 5) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_5_trxeth_close_perc_chg\n                                            ,(((trxeth_close - LEAD(trxeth_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))\n                                            - ((trxeth_close - LEAD(trxeth_close, 5) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 5) OVER (ORDER BY btcusdt_trade_minute DESC))) * 100 AS prev_5_trxeth_close_rate_chg\n                                            ,((trxeth_high - LEAD(trxeth_high, 5) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_high, 5) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_5_trxeth_high_perc_chg\n                                            ,((trxeth_low - LEAD(trxeth_low, 5) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_low, 5) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_5_trxeth_low_perc_chg\n                                            ,COALESCE(TRY(((trxeth_volume - LEAD(trxeth_volume, 5) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_volume, 5) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100),0) AS prev_5_trxeth_volume_perc_chg\n                                            ,((trxeth_close - LEAD(trxeth_close, 5) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 5) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 * trxeth_volume AS prev_5_trxeth_volume_direction,((trxeth_close - LEAD(trxeth_close, 10) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 10) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_10_trxeth_close_perc_chg\n                                            ,(((trxeth_close - LEAD(trxeth_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))\n                                            - ((trxeth_close - LEAD(trxeth_close, 10) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 10) OVER (ORDER BY btcusdt_trade_minute DESC))) * 100 AS prev_10_trxeth_close_rate_chg\n                                            ,((trxeth_high - LEAD(trxeth_high, 10) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_high, 10) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_10_trxeth_high_perc_chg\n                                            ,((trxeth_low - LEAD(trxeth_low, 10) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_low, 10) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_10_trxeth_low_perc_chg\n                                            ,COALESCE(TRY(((trxeth_volume - LEAD(trxeth_volume, 10) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_volume, 10) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100),0) AS prev_10_trxeth_volume_perc_chg\n                                            ,((trxeth_close - LEAD(trxeth_close, 10) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 10) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 * trxeth_volume AS prev_10_trxeth_volume_direction,((trxeth_close - LEAD(trxeth_close, 20) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 20) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_20_trxeth_close_perc_chg\n                                            ,(((trxeth_close - LEAD(trxeth_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))\n                                            - ((trxeth_close - LEAD(trxeth_close, 20) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 20) OVER (ORDER BY btcusdt_trade_minute DESC))) * 100 AS prev_20_trxeth_close_rate_chg\n                                            ,((trxeth_high - LEAD(trxeth_high, 20) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_high, 20) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_20_trxeth_high_perc_chg\n                                            ,((trxeth_low - LEAD(trxeth_low, 20) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_low, 20) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_20_trxeth_low_perc_chg\n                                            ,COALESCE(TRY(((trxeth_volume - LEAD(trxeth_volume, 20) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_volume, 20) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100),0) AS prev_20_trxeth_volume_perc_chg\n                                            ,((trxeth_close - LEAD(trxeth_close, 20) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 20) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 * trxeth_volume AS prev_20_trxeth_volume_direction,((trxeth_close - LEAD(trxeth_close, 30) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 30) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_30_trxeth_close_perc_chg\n                                            ,(((trxeth_close - LEAD(trxeth_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))\n                                            - ((trxeth_close - LEAD(trxeth_close, 30) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 30) OVER (ORDER BY btcusdt_trade_minute DESC))) * 100 AS prev_30_trxeth_close_rate_chg\n                                            ,((trxeth_high - LEAD(trxeth_high, 30) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_high, 30) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_30_trxeth_high_perc_chg\n                                            ,((trxeth_low - LEAD(trxeth_low, 30) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_low, 30) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_30_trxeth_low_perc_chg\n                                            ,COALESCE(TRY(((trxeth_volume - LEAD(trxeth_volume, 30) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_volume, 30) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100),0) AS prev_30_trxeth_volume_perc_chg\n                                            ,((trxeth_close - LEAD(trxeth_close, 30) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 30) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 * trxeth_volume AS prev_30_trxeth_volume_direction,((trxeth_close - LEAD(trxeth_close, 40) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 40) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_40_trxeth_close_perc_chg\n                                            ,(((trxeth_close - LEAD(trxeth_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))\n                                            - ((trxeth_close - LEAD(trxeth_close, 40) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 40) OVER (ORDER BY btcusdt_trade_minute DESC))) * 100 AS prev_40_trxeth_close_rate_chg\n                                            ,((trxeth_high - LEAD(trxeth_high, 40) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_high, 40) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_40_trxeth_high_perc_chg\n                                            ,((trxeth_low - LEAD(trxeth_low, 40) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_low, 40) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_40_trxeth_low_perc_chg\n                                            ,COALESCE(TRY(((trxeth_volume - LEAD(trxeth_volume, 40) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_volume, 40) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100),0) AS prev_40_trxeth_volume_perc_chg\n                                            ,((trxeth_close - LEAD(trxeth_close, 40) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 40) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 * trxeth_volume AS prev_40_trxeth_volume_direction,((trxeth_close - LEAD(trxeth_close, 50) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 50) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_50_trxeth_close_perc_chg\n                                            ,(((trxeth_close - LEAD(trxeth_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))\n                                            - ((trxeth_close - LEAD(trxeth_close, 50) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 50) OVER (ORDER BY btcusdt_trade_minute DESC))) * 100 AS prev_50_trxeth_close_rate_chg\n                                            ,((trxeth_high - LEAD(trxeth_high, 50) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_high, 50) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_50_trxeth_high_perc_chg\n                                            ,((trxeth_low - LEAD(trxeth_low, 50) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_low, 50) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_50_trxeth_low_perc_chg\n                                            ,COALESCE(TRY(((trxeth_volume - LEAD(trxeth_volume, 50) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_volume, 50) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100),0) AS prev_50_trxeth_volume_perc_chg\n                                            ,((trxeth_close - LEAD(trxeth_close, 50) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 50) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 * trxeth_volume AS prev_50_trxeth_volume_direction,((trxeth_close - LEAD(trxeth_close, 60) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 60) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_60_trxeth_close_perc_chg\n                                            ,(((trxeth_close - LEAD(trxeth_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))\n                                            - ((trxeth_close - LEAD(trxeth_close, 60) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 60) OVER (ORDER BY btcusdt_trade_minute DESC))) * 100 AS prev_60_trxeth_close_rate_chg\n                                            ,((trxeth_high - LEAD(trxeth_high, 60) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_high, 60) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_60_trxeth_high_perc_chg\n                                            ,((trxeth_low - LEAD(trxeth_low, 60) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_low, 60) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_60_trxeth_low_perc_chg\n                                            ,COALESCE(TRY(((trxeth_volume - LEAD(trxeth_volume, 60) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_volume, 60) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100),0) AS prev_60_trxeth_volume_perc_chg\n                                            ,((trxeth_close - LEAD(trxeth_close, 60) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 60) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 * trxeth_volume AS prev_60_trxeth_volume_direction,((trxeth_close - LEAD(trxeth_close, 120) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 120) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_120_trxeth_close_perc_chg\n                                            ,(((trxeth_close - LEAD(trxeth_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))\n                                            - ((trxeth_close - LEAD(trxeth_close, 120) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 120) OVER (ORDER BY btcusdt_trade_minute DESC))) * 100 AS prev_120_trxeth_close_rate_chg\n                                            ,((trxeth_high - LEAD(trxeth_high, 120) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_high, 120) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_120_trxeth_high_perc_chg\n                                            ,((trxeth_low - LEAD(trxeth_low, 120) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_low, 120) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_120_trxeth_low_perc_chg\n                                            ,COALESCE(TRY(((trxeth_volume - LEAD(trxeth_volume, 120) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_volume, 120) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100),0) AS prev_120_trxeth_volume_perc_chg\n                                            ,((trxeth_close - LEAD(trxeth_close, 120) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 120) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 * trxeth_volume AS prev_120_trxeth_volume_direction,((trxeth_close - LEAD(trxeth_close, 240) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 240) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_240_trxeth_close_perc_chg\n                                            ,(((trxeth_close - LEAD(trxeth_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))\n                                            - ((trxeth_close - LEAD(trxeth_close, 240) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 240) OVER (ORDER BY btcusdt_trade_minute DESC))) * 100 AS prev_240_trxeth_close_rate_chg\n                                            ,((trxeth_high - LEAD(trxeth_high, 240) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_high, 240) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_240_trxeth_high_perc_chg\n                                            ,((trxeth_low - LEAD(trxeth_low, 240) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_low, 240) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_240_trxeth_low_perc_chg\n                                            ,COALESCE(TRY(((trxeth_volume - LEAD(trxeth_volume, 240) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_volume, 240) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100),0) AS prev_240_trxeth_volume_perc_chg\n                                            ,((trxeth_close - LEAD(trxeth_close, 240) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 240) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 * trxeth_volume AS prev_240_trxeth_volume_direction,((trxeth_close - LEAD(trxeth_close, 480) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 480) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_480_trxeth_close_perc_chg\n                                            ,(((trxeth_close - LEAD(trxeth_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))\n                                            - ((trxeth_close - LEAD(trxeth_close, 480) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 480) OVER (ORDER BY btcusdt_trade_minute DESC))) * 100 AS prev_480_trxeth_close_rate_chg\n                                            ,((trxeth_high - LEAD(trxeth_high, 480) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_high, 480) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_480_trxeth_high_perc_chg\n                                            ,((trxeth_low - LEAD(trxeth_low, 480) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_low, 480) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_480_trxeth_low_perc_chg\n                                            ,COALESCE(TRY(((trxeth_volume - LEAD(trxeth_volume, 480) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_volume, 480) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100),0) AS prev_480_trxeth_volume_perc_chg\n                                            ,((trxeth_close - LEAD(trxeth_close, 480) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 480) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 * trxeth_volume AS prev_480_trxeth_volume_direction,((trxeth_close - LEAD(trxeth_close, 960) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 960) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_960_trxeth_close_perc_chg\n                                            ,(((trxeth_close - LEAD(trxeth_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 1) OVER (ORDER BY btcusdt_trade_minute DESC))\n                                            - ((trxeth_close - LEAD(trxeth_close, 960) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 960) OVER (ORDER BY btcusdt_trade_minute DESC))) * 100 AS prev_960_trxeth_close_rate_chg\n                                            ,((trxeth_high - LEAD(trxeth_high, 960) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_high, 960) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_960_trxeth_high_perc_chg\n                                            ,((trxeth_low - LEAD(trxeth_low, 960) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_low, 960) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 AS prev_960_trxeth_low_perc_chg\n                                            ,COALESCE(TRY(((trxeth_volume - LEAD(trxeth_volume, 960) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_volume, 960) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100),0) AS prev_960_trxeth_volume_perc_chg\n                                            ,((trxeth_close - LEAD(trxeth_close, 960) OVER (ORDER BY btcusdt_trade_minute DESC)) \n                                                / LEAD(trxeth_close, 960) OVER (ORDER BY btcusdt_trade_minute DESC)) * 100 * trxeth_volume AS prev_960_trxeth_volume_direction\n                                ,((LAG(btcusdt_close, 3) OVER (ORDER BY btcusdt_trade_minute DESC) - btcusdt_close) / btcusdt_close) * 100 AS futr_3_close_perc_chg,((LAG(btcusdt_close, 4) OVER (ORDER BY btcusdt_trade_minute DESC) - btcusdt_close) / btcusdt_close) * 100 AS futr_4_close_perc_chg,((LAG(btcusdt_close, 5) OVER (ORDER BY btcusdt_trade_minute DESC) - btcusdt_close) / btcusdt_close) * 100 AS futr_5_close_perc_chg,((LAG(btcusdt_close, 6) OVER (ORDER BY btcusdt_trade_minute DESC) - btcusdt_close) / btcusdt_close) * 100 AS futr_6_close_perc_chg,((LAG(btcusdt_close, 7) OVER (ORDER BY btcusdt_trade_minute DESC) - btcusdt_close) / btcusdt_close) * 100 AS futr_7_close_perc_chg\n                            FROM target_btcusdt LEFT JOIN alt_ethusdt ON target_btcusdt.btcusdt_trade_minute = alt_ethusdt.ethusdt_trade_minute LEFT JOIN through_trxeth ON target_btcusdt.btcusdt_trade_minute = through_trxeth.trxeth_trade_minute LEFT JOIN excharb_btc_btcusdt ON target_btcusdt.btcusdt_trade_minute = excharb_btc_btcusdt.btcusdt_trade_minute LEFT JOIN excharb_eth_ethusdt ON target_btcusdt.btcusdt_trade_minute = excharb_eth_ethusdt.ethusdt_trade_minute\n                            ORDER BY btcusdt_trade_minute ASC", 'ResultConfiguration': {'OutputLocation': 's3://loidsig-crypto/athena_results/10e07f8c-5476-414c-a833-0a4f842e2dde.csv'}, 'QueryExecutionContext': {'Database': 'hodl'}, 'Status': {'State': 'FAILED', 'StateChangeReason': "SYNTAX_ERROR: line 62:36: Column 'btcusdt_trade_datetime' is ambiguous", 'SubmissionDateTime': datetime.datetime(2018, 8, 25, 3, 56, 32, 859000, tzinfo=tzlocal()), 'CompletionDateTime': datetime.datetime(2018, 8, 25, 3, 56, 34, 334000, tzinfo=tzlocal())}, 'Statistics': {'EngineExecutionTimeInMillis': 982, 'DataScannedInBytes': 0}}, 'ResponseMetadata': {'RequestId': '09ccc7ad-693a-44a4-9066-3cdac154698e', 'HTTPStatusCode': 200, 'HTTPHeaders': {'content-type': 'application/x-amz-json-1.1', 'date': 'Sat, 25 Aug 2018 03:56:33 GMT', 'x-amzn-requestid': '09ccc7ad-693a-44a4-9066-3cdac154698e', 'content-length': '163756', 'connection': 'keep-alive'}, 'RetryAttempts': 0}}
(0, 0)
(0, 0)
Model: linear
2018-08-25 03:56:34
Traceback (most recent call last):
  File "/usr/local/anaconda/lib/python3.6/site-packages/pandas/core/indexing.py", line 1506, in _has_valid_type
    error()
  File "/usr/local/anaconda/lib/python3.6/site-packages/pandas/core/indexing.py", line 1501, in error
    axis=self.obj._get_axis_name(axis)))
KeyError: 'the label [btcusdt_trade_date] is not in the [columns]'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "src/the_sim/return_simulation.py", line 303, in <module>
    main()
  File "src/the_sim/return_simulation.py", line 109, in main
    days_to_test = features_df.loc[start_ix:,f'{target_coin}_trade_date'].nunique()
  File "/usr/local/anaconda/lib/python3.6/site-packages/pandas/core/indexing.py", line 1367, in __getitem__
    return self._getitem_tuple(key)
  File "/usr/local/anaconda/lib/python3.6/site-packages/pandas/core/indexing.py", line 858, in _getitem_tuple
    return self._getitem_lowerdim(tup)
  File "/usr/local/anaconda/lib/python3.6/site-packages/pandas/core/indexing.py", line 991, in _getitem_lowerdim
    section = self._getitem_axis(key, axis=i)
  File "/usr/local/anaconda/lib/python3.6/site-packages/pandas/core/indexing.py", line 1626, in _getitem_axis
    self._has_valid_type(key, axis)
  File "/usr/local/anaconda/lib/python3.6/site-packages/pandas/core/indexing.py", line 1514, in _has_valid_type
    error()
  File "/usr/local/anaconda/lib/python3.6/site-packages/pandas/core/indexing.py", line 1501, in error
    axis=self.obj._get_axis_name(axis)))
KeyError: 'the label [btcusdt_trade_date] is not in the [columns]'
Failed with exit code: 1
